{% extends "base.html" %}

{% block header %}
<header class="header collection-header">
    <h1>{{ collection.title }}</h1>
    <p class="subtitle">{{ collection.subtitle }}</p>
</header>
{% endblock %}

{% block content %}
<div class="back-wrapper">
    <a href="/" class="back-button">
        <i class="fas fa-arrow-left"></i> Назад
    </a>
</div>
<div class="collection-description">
    <p>{{ collection.description }}</p>
</div>

{# Блок закрепленного товара для LM_Collection #}
{% if collection.id == "LM_Collection" %}
    {% set featured = None %}
    {% for figure in figures %}
        {% if figure.status == "featured" %}
            {% set featured = figure %}
        {% endif %}
    {% endfor %}
    {% if featured %}
    <div class="featured-figure">
        <div class="featured-figure-image">
            <img src="{{ featured.images[0] }}" alt="{{ featured.title }}">
        </div>
        <div class="featured-figure-content">
            <h2>{{ featured.title }}</h2>
            <p>{{ featured.description }}</p>
            <a href="https://t.me/dikayl" target="_blank" class="featured-figure-button">
                <span class="tg-icon">&#128236;</span>
                {{ featured.button.text }}
            </a>
        </div>
    </div>
    <hr style="margin:32px 0;">
    {% endif %}
{% endif %}

<div class="figures-list">
    {% for figure in figures %}
        {% if figure.status != "featured" %}
        <a href="/figure/{{ figure.id }}" class="figure-item">
            <div class="figure-item-image">
                <img src="{{ figure.images[0] }}" alt="{{ figure.title }}" onerror="this.src='https://via.placeholder.com/100x100/1A1A1A/7C4DFF?text={{ figure.title|urlencode }}'">
            </div>
            <div class="figure-item-content">
                <h3 class="figure-item-title">{{ figure.title }}</h3>
                <div class="figure-item-price">{{ figure.price }}</div>
                <div class="figure-item-meta">
                    <span class="status status-{{ figure.status }}">{{ figure.status_text }}</span>
                    <span class="figure-item-size">{{ figure.size }}</span>
                </div>
            </div>
        </a>
        {% endif %}
    {% endfor %}
</div>
{% endblock %}